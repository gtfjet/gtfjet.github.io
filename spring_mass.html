<!DOCTYPE html>
<html>
<head>
<title>Animator</title>
</head>
<body>
<script>
let dt = 0.01;
let diagram = document.createElementNS("http://www.w3.org/2000/svg", 'svg');
//diagram.setAttribute('viewbox', '0 0 1000 1000');
diagram.setAttribute('width', '1000px');
diagram.setAttribute('height', '1000px');
document.body.appendChild(diagram);

class Flange {
  constructor() {
    this.x  = 0;
    this.y  = 0;
    this.fx = 0;
    this.fy = 0;
  }
}

class Mount {
  constructor() {
    this.flange = new Flange();
    this.svg = document.createElementNS("http://www.w3.org/2000/svg", 'rect');
    this.svg.setAttribute('fill', '#000000');
    this.svg.setAttribute('width', 20);
    this.svg.setAttribute('height', 20);
    diagram.appendChild(this.svg);
  }
  animate() {
    this.svg.setAttribute('x',this.flange.x-10);
    this.svg.setAttribute('y',this.flange.y-10);
  }
  calculate() {
  }
}

class Mass {
  constructor() {
    this.m = 1;
    this.flange = new Flange();
    this.r = 5;
    this.vx = 0;
    this.vy = 0;
    this.svg = document.createElementNS("http://www.w3.org/2000/svg", 'circle');
    this.svg.setAttribute('fill', '#0000FF');
    diagram.appendChild(this.svg);
  }
  animate() {
    this.svg.setAttribute( 'r',this.r);
    this.svg.setAttribute('cx',this.flange.x);
    this.svg.setAttribute('cy',this.flange.y);
  }
  calculate() {
    this.vx += this.flange.fx / this.m * dt;
    this.vy += (this.flange.fy / this.m + 50 ) * dt;
    this.flange.x += this.vx * dt;
    this.flange.y += this.vy * dt;
  }
}

class Spring {
  flange_a; flange_b;
  constructor() {
    this.k = 1;
    this.svg = document.createElementNS("http://www.w3.org/2000/svg", 'line');
    this.svg.setAttribute('stroke', '#00FFFF');
    diagram.appendChild(this.svg);
  }
  animate() {
    this.svg.setAttribute('x1',this.flange_a.x);
    this.svg.setAttribute('y1',this.flange_a.y);
    this.svg.setAttribute('x2',this.flange_b.x);
    this.svg.setAttribute('y2',this.flange_b.y);
  }
  calculate() {
    var dx = this.flange_a.x - this.flange_b.x;
    var dy = this.flange_a.y - this.flange_b.y;
    this.flange_a.fx += -this.k*dx;
    this.flange_a.fy += -this.k*dy;
    this.flange_b.fx += this.k*dx;
    this.flange_b.fy += this.k*dy;
  }
}

let mount1 = new Mount();
mount1.flange.x = 500;
mount1.flange.y = 300;

let mass1 = new Mass();
mass1.flange.x = 600;
mass1.flange.y = 250;
mass1.vx = 0;
mass1.vy = 20;
mass1.r = 10;

let mass2 = new Mass();
mass2.flange.x = 400;
mass2.flange.y = 350;
mass2.vx = -15;
mass2.vy = 10;
mass2.m = 0.5;

let spring1 = new Spring();
let spring2 = new Spring();

spring1.flange_b = mount1.flange;
spring1.flange_a = mass1.flange;
spring2.flange_b = mass1.flange;
spring2.flange_a = mass2.flange;

function run() {
  mass1.flange.fx=0;
  mass1.flange.fy=0;
  mass2.flange.fx=0;
  mass2.flange.fy=0;
  mount1.flange.fx=0;
  mount1.flange.fy=0;
  spring1.calculate();
  spring1.animate();
  spring2.calculate();
  spring2.animate();
  mass1.calculate();
  mass1.animate();
  mass2.calculate();
  mass2.animate();
  mount1.calculate();
  mount1.animate();
}
let myVar = setInterval(run,10);

</script>
</body>
</html>